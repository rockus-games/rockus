from sklearn.neighbors import KNeighborsClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
import pandas as pd


# 1 - яблоки; 2 - арбузы 

# Загружаем датасет
data = pd.read_csv('fruits.csv')


X = data[['mass', 'width', 'height']].values

# Выбираем целевую переменную (метку класса)
y = data['fruit_label'].values

# Разделим датасет на обученную и тестовую части
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Создадим классификатор k ближайших соседей
k = 5
knn = KNeighborsClassifier(n_neighbors=k)

# Обучим классификатор из обучаемых данных
knn.fit(X_train,y_train)

# Создаём предсказания на тестовых данных
y_pred = knn.predict(X_test)

# Оценим точность классификации на тестовых данных
accuracy = accuracy_score(y_test, y_pred)
print(f"Точность предсказаний:{accuracy}")

fruit = [[3920, 40, 35]]
print(knn.predict(fruit))


